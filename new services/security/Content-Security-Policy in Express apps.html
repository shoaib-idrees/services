<!DOCTYPE html>
<!-- saved from url=(0068)https://ponyfoo.com/articles/content-security-policy-in-express-apps -->
<html lang="en" itemscope="" itemtype="http://schema.org/Blog" class="i18n-en ua-chrome ly-full ly-custom-subheading ly-custom-heading"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Content-Security-Policy in Express apps</title><script async="" src="./Content-Security-Policy in Express apps_files/monetization.js"></script><script async="" src="./Content-Security-Policy in Express apps_files/widgets.js"></script><script async="" src="./Content-Security-Policy in Express apps_files/ei.js"></script><script async="" src="./Content-Security-Policy in Express apps_files/analytics.js"></script><script async="" src="./Content-Security-Policy in Express apps_files/js"></script><script async="" src="./Content-Security-Policy in Express apps_files/uwt.js"></script><script async="" src="./Content-Security-Policy in Express apps_files/oct.js"></script><link rel="icon" sizes="192x192" href="https://ponyfoo.com/touch-icon-192x192.png"><link rel="apple-touch-icon" sizes="180x180" href="https://ponyfoo.com/apple-touch-icon-180x180.png"><link rel="apple-touch-icon" sizes="152x152" href="https://ponyfoo.com/apple-touch-icon-152x152.png"><link rel="apple-touch-icon" sizes="144x144" href="https://ponyfoo.com/apple-touch-icon-144x144.png"><link rel="apple-touch-icon" sizes="120x120" href="https://ponyfoo.com/apple-touch-icon-120x120.png"><link rel="apple-touch-icon" sizes="114x114" href="https://ponyfoo.com/apple-touch-icon-114x114.png"><link rel="apple-touch-icon" sizes="76x76" href="https://ponyfoo.com/apple-touch-icon-76x76.png"><link rel="apple-touch-icon" sizes="72x72" href="https://ponyfoo.com/apple-touch-icon-72x72.png"><link rel="apple-touch-icon" sizes="60x60" href="https://ponyfoo.com/apple-touch-icon-60x60.png"><link rel="apple-touch-icon" sizes="57x57" href="https://ponyfoo.com/apple-touch-icon-57x57.png"><link rel="apple-touch-icon" sizes="180x180" href="https://ponyfoo.com/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" sizes="180x180" href="https://ponyfoo.com/apple-touch-icon-precomposed.png"><link rel="icon" type="image/png" sizes="194x194" href="https://ponyfoo.com/favicon-194x194.png"><link rel="icon" type="image/png" sizes="96x96" href="https://ponyfoo.com/favicon-96x96.png"><link rel="icon" type="image/png" sizes="32x32" href="https://ponyfoo.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://ponyfoo.com/favicon-16x16.png"><meta name="theme-color" content="#e92c6c"><meta name="apple-mobile-web-app-status-bar-style" content="#e92c6c"><meta name="msapplication-navbutton-color" content="#e92c6c"><meta name="msapplication-TileColor" content="#e92c6c"><meta name="msapplication-TileImage" content="/apple-touch-icon-144x144-precomposed.png"><link rel="icon" type="image/png" sizes="192x192" href="https://ponyfoo.com/android-chrome-192x192.png"><link rel="mask-icon" href="https://ponyfoo.com/mask-grayscale-512x512.min.svg" color="#e92c6c"><meta name="twitter:widgets:link-color" content="#e92c6c"><link rel="manifest" href="https://ponyfoo.com/manifest.json"><meta name="mobile-web-app-capable" content="yes"><script nonce="">addEventListener('error',__e=function f(e){f.q=f.q||[];f.q.push(e)})
</script><link rel="alternate" type="application/rss+xml" href="https://feeds.feedburner.com/ponyfoo"><link rel="alternate" type="application/json" href="https://ponyfoo.com/feed.json"><link rel="search" type="application/opensearchdescription+xml" title="Pony Foo" href="https://ponyfoo.com/opensearch.xml"><link rel="canonical" href="https://ponyfoo.com/articles/content-security-policy-in-express-apps"><meta name="author" itemprop="creator" content="Nicol√°s Bevacqua"><meta name="keywords" content="csp,security,http"><meta name="description" property="og:description" itemprop="description" content="The Content-Security-Policy header is a bit frightening ‚Äî will I break my website if I suddenly start blocking requests for external resources? In this article we go over a gradual approach to adopting CSP. üîê
"><meta property="og:site_name" content="Pony Foo"><meta property="og:url" itemprop="url" content="https://ponyfoo.com/articles/content-security-policy-in-express-apps"><meta name="twitter:title" itemprop="name" property="og:title" content="Content-Security-Policy in Express apps"><meta name="twitter:description" content="The Content-Security-Policy header is a bit frightening ‚Äî will I break my website if I suddenly start blocking requests for external resources? In this article we go over a gradual approach to adopting CSP. üîê
"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@ponyfoo"><meta name="twitter:creator" content="@nzgb"><meta name="twitter:widgets:csp" content="on"><meta name="twitter:widgets:dnt" content="on"><meta property="og:image" itemprop="images" content="https://i.imgur.com/r9vWGRr.png"><meta property="og:image" content="https://i.imgur.com/J6C8BRe.jpg"><meta property="og:image" content="https://ponyfoo.com/img/banners/branded.b2b85b77.png"><meta name="twitter:image:src" content="https://i.imgur.com/r9vWGRr.png"><link rel="stylesheet" type="text/css" href="./Content-Security-Policy in Express apps_files/all.1c285cc7.css"><script nonce="">!function(){function e(t,n,o){function i(a,s){if(!n[a]){if(!t[a]){var f="function"==typeof require&&require;if(!s&&f)return f(a,!0);if(r)return r(a,!0);var c=Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[a]={exports:{}};t[a][0].call(l.exports,function(e){return i(t[a][1][e]||e)},l,l.exports,e,t,n,o)}return n[a].exports}for(var r="function"==typeof require&&require,a=0;a<o.length;a++)i(o[a]);return i}return e}()({1:[function(e,t,n){"use strict";function o(){i("Merriweather","ly-custom-subheading"),i("Neuton","ly-custom-heading")}function i(e,t){if(t in c){if(c[t].once)return}else c[t]=r(t);f&&localStorage["fonts:"+t]?c[t]():a(e,{success:c[t],weight:700})}function r(e){return function t(){if(!t.once){t.once=!0;var n=document.documentElement,o=n.className.length?" ":"";n.className+=o+e,f&&(localStorage["fonts:"+e]=!0)}}}var a=e(3),s=e(2),f="localStorage"in window,c={},l=document.createElement("link"),u=document.getElementsByTagName("head")[0];l.rel="stylesheet",l.href="https://fonts.googleapis.com/css?family=Neuton:700|Merriweather:400italic,400,700",l.media="only x",u.appendChild(l),setTimeout(function(){l.media="all"}),o(),setTimeout(o,0),s(window,o),s(window,o,!0)},{2:2,3:3}],2:[function(e,t,n){"use strict";t.exports=function(e,t,n){var o=!1,i=!0,r=e.document,a=r.documentElement,s=r.addEventListener,f=s?"addEventListener":"attachEvent",c=s?"removeEventListener":"detachEvent",l=s?"":"on",u=function n(i){"readystatechange"==i.type&&"complete"!=r.readyState||(("load"==i.type?e:r)[c](l+i.type,n,!1),!o&&(o=!0)&&t.call(e,i.type||i))};if("complete"==r.readyState)t.call(e,"lazy");else{if(!s&&a.doScroll){try{i=!e.frameElement}catch(e){}i&&function e(){try{a.doScroll("left")}catch(t){return void setTimeout(e,50)}u("poll")}()}n||(r[f](l+"DOMContentLoaded",u,!1),r[f](l+"readystatechange",u,!1)),e[f](l+"load",u,!1)}}},{}],3:[function(e,t,n){(function(e){"use strict";var n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(e,t,o,i,r){!function(o,r){"function"===typeof i&&i.amd?i([],r):"object"===("undefined"===typeof t?"undefined":n(t))?e.exports=r():o.FontFaceOnload=r()}(this,function(){var e={tolerance:2,delay:100,glyphs:"",success:function(){},error:function(){},timeout:5e3,weight:"400",style:"normal",window:window},t=["display:block","position:absolute","top:-999px","left:-999px","font-size:48px","width:auto","height:auto","line-height:normal","margin:0","padding:0","font-variant:normal","white-space:nowrap"],n='<div style="%s" aria-hidden="true">AxmTYklsjo190QW</div>',o=function(){this.fontFamily="",this.appended=!1,this.serif=void 0,this.sansSerif=void 0,this.parent=void 0,this.options={}};o.prototype.getMeasurements=function(){return{sansSerif:{width:this.sansSerif.offsetWidth,height:this.sansSerif.offsetHeight},serif:{width:this.serif.offsetWidth,height:this.serif.offsetHeight}}},o.prototype.load=function(){function e(e){return t.concat(["font-weight:"+d.weight,"font-style:"+d.style]).concat("font-family:"+e).join(";")}function o(e,t,n){return Math.abs(e.width-t.offsetWidth)>n||Math.abs(e.height-t.offsetHeight)>n}function i(){return(new Date).getTime()-a.getTime()>d.timeout}var r,a=new Date,s=this,f=s.serif,c=s.sansSerif,l=s.parent,u=s.appended,d=s.options,p=d.reference,h=n.replace(/\%s/,e("sans-serif")),m=n.replace(/\%s/,e("serif"));l||(l=s.parent=d.window.document.createElement("div")),l.innerHTML=h+m,c=s.sansSerif=l.firstChild,f=s.serif=c.nextSibling,d.glyphs&&(c.innerHTML+=d.glyphs,f.innerHTML+=d.glyphs),function e(){p||(p=d.window.document.body),!u&&p&&(p.appendChild(l),u=s.appended=!0,r=s.getMeasurements(),c.style.fontFamily=s.fontFamily+", sans-serif",f.style.fontFamily=s.fontFamily+", serif"),u&&r&&(o(r.sansSerif,c,d.tolerance)||o(r.serif,f,d.tolerance))?d.success():i()?d.error():!u&&"requestAnimationFrame"in d.window?d.window.requestAnimationFrame(e):d.window.setTimeout(e,d.delay)}()},o.prototype.cleanFamilyName=function(e){return e.replace(/[\'\"]/g,"").toLowerCase()},o.prototype.cleanWeight=function(e){return""+({normal:"400",bold:"700"}[e]||e)},o.prototype.checkFontFaces=function(e){var t=this;t.options.window.document.fonts.forEach(function(n){t.cleanFamilyName(n.family)===t.cleanFamilyName(t.fontFamily)&&t.cleanWeight(n.weight)===t.cleanWeight(t.options.weight)&&n.style===t.options.style&&n.load().then(function(){t.options.success(n),t.options.window.clearTimeout(e)})})},o.prototype.init=function(t,n){var o;for(var i in e)n.hasOwnProperty(i)||(n[i]=e[i]);this.options=n,this.fontFamily=t,!n.glyphs&&"fonts"in n.window.document?(n.timeout&&(o=n.window.setTimeout(function(){n.error()},n.timeout)),this.checkFontFaces(o)):this.load()};return function(e,t){var n=new o;return n.init(e,t),n}}),r("undefined"!=typeof FontFaceOnload?FontFaceOnload:window.FontFaceOnload)}).call(e,void 0,void 0,void 0,void 0,function(e){t.exports=e})}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}]},{},[1]);</script><link rel="stylesheet" href="./Content-Security-Policy in Express apps_files/css" media="all"><noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Neuton:700|Merriweather:400italic,400,700"><style>.js-only{display:none !important}
</style></noscript><script id="_carbonads_projs" type="text/javascript" src="./Content-Security-Policy in Express apps_files/CKYI553L.json"></script><div id="_bsa_srv-CVAIE2QM_2"></div></head><body id="top"><header class="ly-header vw-title"><h1 class="go-logo-container"><span class="go-anchor gg-container"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="156" height="156" viewBox="0 0 13 13" shape-rendering="crispEdges" aria-hidden="true" class="go-logo"><rect width="1" height="1" x="11" fill="#666666"></rect><rect width="1" height="1" x="12" fill="#1a1a1a"></rect><rect width="1" height="1" x="10" y="1" fill="#4d4d4d"></rect><rect width="1" height="1" x="11" y="1"></rect><rect width="1" height="1" x="3" y="2" fill="#333333"></rect><rect width="1" height="1" x="4" y="2"></rect><rect width="1" height="1" x="5" y="2" fill="#1a1a1a"></rect><rect width="1" height="1" x="7" y="2" fill="#1a1a1a"></rect><rect width="1" height="1" x="9" y="2" fill="#333333"></rect><rect width="1" height="1" x="10" y="2"></rect><rect width="1" height="1" x="2" y="3" fill="#333333"></rect><rect width="1" height="1" x="3" y="3"></rect><rect width="1" height="1" x="4" y="3"></rect><rect width="1" height="1" x="5" y="3"></rect><rect width="1" height="1" x="6" y="3"></rect><rect width="1" height="1" x="7" y="3"></rect><rect width="1" height="1" x="8" y="3"></rect><rect width="1" height="1" x="9" y="3"></rect><rect width="1" height="1" x="1" y="4" fill="#333333"></rect><rect width="1" height="1" x="2" y="4" fill="#1a1a1a"></rect><rect width="1" height="1" x="3" y="4"></rect><rect width="1" height="1" x="4" y="4"></rect><rect width="1" height="1" x="5" y="4"></rect><rect width="1" height="1" x="6" y="4"></rect><rect width="1" height="1" x="7" y="4"></rect><rect width="1" height="1" x="8" y="4"></rect><rect width="1" height="1" x="9" y="4"></rect><rect width="1" height="1" y="5" fill="#333333"></rect><rect width="1" height="1" x="1" y="5" fill="#1a1a1a"></rect><rect width="1" height="1" x="2" y="5"></rect><rect width="1" height="1" x="3" y="5"></rect><rect width="1" height="1" x="4" y="5"></rect><rect width="1" height="1" x="5" y="5"></rect><rect width="1" height="1" x="6" y="5" fill="#26ef00"></rect><rect width="1" height="1" x="7" y="5" fill="#26e400"></rect><rect width="1" height="1" x="8" y="5"></rect><rect width="1" height="1" x="9" y="5"></rect><rect width="1" height="1" x="10" y="5" fill="#1a1a1a"></rect><rect width="1" height="1" y="6"></rect><rect width="1" height="1" x="1" y="6"></rect><rect width="1" height="1" x="2" y="6"></rect><rect width="1" height="1" x="3" y="6"></rect><rect width="1" height="1" x="4" y="6"></rect><rect width="1" height="1" x="5" y="6"></rect><rect width="1" height="1" x="6" y="6" fill="#26ef00"></rect><rect width="1" height="1" x="7" y="6" fill="#26ef00"></rect><rect width="1" height="1" x="8" y="6"></rect><rect width="1" height="1" x="9" y="6"></rect><rect width="1" height="1" y="7"></rect><rect width="1" height="1" x="1" y="7"></rect><rect width="1" height="1" x="2" y="7"></rect><rect width="1" height="1" x="3" y="7"></rect><rect width="1" height="1" x="4" y="7"></rect><rect width="1" height="1" x="5" y="7"></rect><rect width="1" height="1" x="6" y="7"></rect><rect width="1" height="1" x="7" y="7"></rect><rect width="1" height="1" x="8" y="7"></rect><rect width="1" height="1" x="9" y="7"></rect><rect width="1" height="1" y="8"></rect><rect width="1" height="1" x="1" y="8"></rect><rect width="1" height="1" x="2" y="8"></rect><rect width="1" height="1" x="3" y="8"></rect><rect width="1" height="1" x="4" y="8"></rect><rect width="1" height="1" x="5" y="8"></rect><rect width="1" height="1" x="6" y="8"></rect><rect width="1" height="1" x="7" y="8"></rect><rect width="1" height="1" x="8" y="8"></rect><rect width="1" height="1" x="9" y="8"></rect><rect width="1" height="1" x="10" y="8" fill="#333333"></rect><rect width="1" height="1" y="9"></rect><rect width="1" height="1" x="1" y="9"></rect><rect width="1" height="1" x="2" y="9"></rect><rect width="1" height="1" x="3" y="9"></rect><rect width="1" height="1" x="4" y="9"></rect><rect width="1" height="1" x="5" y="9"></rect><rect width="1" height="1" x="6" y="9"></rect><rect width="1" height="1" x="7" y="9"></rect><rect width="1" height="1" x="8" y="9"></rect><rect width="1" height="1" x="9" y="9"></rect><rect width="1" height="1" x="10" y="9"></rect><rect width="1" height="1" y="10"></rect><rect width="1" height="1" x="1" y="10"></rect><rect width="1" height="1" x="2" y="10"></rect><rect width="1" height="1" x="3" y="10"></rect><rect width="1" height="1" x="4" y="10"></rect><rect width="1" height="1" x="5" y="10"></rect><rect width="1" height="1" x="6" y="10" fill="#333333"></rect><rect width="1" height="1" x="8" y="10"></rect><rect width="1" height="1" x="9" y="10"></rect><rect width="1" height="1" x="10" y="10"></rect><rect width="1" height="1" y="11"></rect><rect width="1" height="1" x="1" y="11"></rect><rect width="1" height="1" x="2" y="11"></rect><rect width="1" height="1" x="3" y="11"></rect><rect width="1" height="1" x="4" y="11"></rect><rect width="1" height="1" x="5" y="11"></rect><rect width="1" height="1" x="6" y="11"></rect><rect width="1" height="1" x="7" y="11" fill="#333333"></rect><rect width="1" height="1" y="12"></rect><rect width="1" height="1" x="1" y="12"></rect><rect width="1" height="1" x="2" y="12"></rect><rect width="1" height="1" x="3" y="12"></rect><rect width="1" height="1" x="4" y="12"></rect><rect width="1" height="1" x="5" y="12"></rect><rect width="1" height="1" x="6" y="12"></rect><rect width="1" height="1" x="7" y="12"></rect><rect width="1" height="1" x="8" y="12" fill="#333333"></rect><a xlink:href="/" aria-hidden="false" role="link" title="Pony Foo"><rect width="13" height="13" opacity="0" role="img"></rect></a><image src="/img/logos/original.d316b6e4.png" alt="Pony Foo" class="go-logo-image"></image></svg></span><span class="go-text"><a href="https://ponyfoo.com/" class="lk-rainbows">ponyfoo.com</a></span></h1><nav class="hn-navigation"><ul class="hn-list"><li class="hn-item"><a href="https://ponyfoo.com/articles" aria-label="Your planet needs you!" class="hn-link lk-rainbows">Articles</a></li><li class="hn-item"><a href="https://ponyfoo.com/weekly" aria-label="Get our weekly email newsletter!" class="hn-link lk-rainbows">Weekly</a></li><li class="hn-item"><a href="https://ponyfoo.com/books" aria-label="Find books I‚Äôve written and books that I‚Äôm currently writing" class="hn-link lk-rainbows">Books</a></li><li class="hn-item"><a href="https://ponyfoo.com/speaking" aria-label="Find talk videos, slides, and upcoming speaking engagements" class="hn-link lk-rainbows">Speaking</a></li><li class="hn-item"><a href="https://ponyfoo.com/opensource" aria-label="Learn about my contributions to the open-source community" class="hn-link lk-rainbows">Open-Source</a></li><li class="hn-item"><a href="https://shop.ponyfoo.com/" aria-label="Get some of our swag!" target="_blank" rel="noopener noreferrer" class="hn-link lk-rainbows">Shop</a></li></ul></nav></header><main class="ly-main"><header style="background-image:url(&quot;https://i.imgur.com/J6C8BRe.jpg&quot;),url(&quot;data:image/jpeg;base64,/9j/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAALAA4DASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAABgQF/8QAJRAAAQMDBAAHAAAAAAAAAAAAAQIDEQQFIQAGEjEUMkJRcYHR/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhEDEQA/AIaTcrnhW691oN0q5chICzw5EAHqCRHvnPWAiod22FdIhypqyw4fQttUnHYx1Mj6OsbalitirdTBVG0ZWJn5I00Rs2wK81uQZzlxf7oP/9k=&quot;);" class="dc-header at-header"><div class="at-title-wrapper"><h1 itemprop="headline" class="dc-heading at-title"><code class="md-code md-code-inline">Content-Security-Policy</code> in Express apps</h1></div><div class="at-header-tags at-tags"><ul class="tg-tags"><li class="tg-tag-item"><a href="https://ponyfoo.com/articles/tagged/csp" aria-label="Find all articles tagged csp" class="tg-tag lk-link lk-inherited">csp</a></li><li class="tg-tag-item"><a href="https://ponyfoo.com/articles/tagged/security" aria-label="Find all articles tagged security" class="tg-tag lk-link lk-inherited">security</a></li><li class="tg-tag-item"><a href="https://ponyfoo.com/articles/tagged/http" aria-label="Find all articles tagged http" class="tg-tag lk-link lk-inherited">http</a></li></ul></div><header class="att-container"><div class="att-left"><section class="att-author"><a href="https://ponyfoo.com/contributors/ponyfoo" aria-label="Visit their profile" class="att-avatar av-website"><img src="./Content-Security-Policy in Express apps_files/YwsPkpN.jpg" alt="" class="av-avatar av-avatar-large"></a><a href="https://ponyfoo.com/contributors/ponyfoo" aria-label="Visit their profile" class="att-name lk-link lk-white">Nicol√°s Bevacqua</a></section></div><section class="att-metadata"><span class="uv-preserve-whitespace"> </span><span class="aca-items"><span aria-label="Published 11:30 AM, Feb 6, 2017 (GMT)" class="aca-item aca-publication"><span class="fa fa-calendar-o"></span><span> </span><time datetime="2017-02-06T11:30:09.541Z" data-absolute="data-absolute" class="aca-publication-has-year"><span class="aca-publication-month">Feb</span><span class="aca-publication-day-separator"> </span><span class="aca-publication-day">6th</span><span class="aca-publication-year-separator">, </span><span class="aca-publication-year">2017</span></time></span><span> </span><span aria-label="You can read this article in 16 minutes" class="aca-item aca-estimate"><span class="fa fa-hourglass-o"></span><span> </span><span>16m</span></span><span> </span><a href="https://ponyfoo.com/articles/content-security-policy-in-express-apps#comments" aria-label="Go straight for the comments" class="aca-item aca-comments lk-link lk-clean lk-inherited"><span class="fa fa-commenting-o"></span><span> </span><span>0</span></a></span></section></header></header><div class="at-actions"><a href="https://github.com/ponyfoo/articles/tree/noindex/2017/02-03--content-security-policy-in-express-apps" target="_blank" rel="noopener noreferrer" class="at-action-button bt-button bt-small bt-turquoise"><i class="fa fa-code-fork"></i><span> </span><span>Fix</span></a></div><section class="at-container de-host"><div class="de-column"><div class="at-section bs-container"><div class="aaf-container"><div class="aaf-loading"><span>A relevant ad will be displayed here soon. These ads help pay for my hosting.</span></div><div class="aaf-content"></div></div></div><section class="dc-role at-teaser"><div class="at-section at-teaser-markdown md-markdown"><p>The <code class="md-code md-code-inline">Content-Security-Policy</code> header is a bit frightening ‚Äî will I break my website if I suddenly start blocking requests for external resources <img class="tj-emoji" draggable="false" alt="üò∞" src="./Content-Security-Policy in Express apps_files/1f630.png">? In this article we go over a gradual approach to adopting CSP, so that you can mitigate the risk of breaking your website while trying to make it more secure. <img class="tj-emoji" draggable="false" alt="üîê" src="./Content-Security-Policy in Express apps_files/1f510.png"></p></div></section><article itemscope="itemscope" itemtype="http://schema.org/BlogPosting" class="at-article ly-section"><meta itemprop="dateCreated" content="2017-02-03T20:28:04.745Z"><meta itemprop="dateModified" content="2018-12-19T20:57:28.496Z"><meta itemprop="datePublished" content="2017-02-06T11:30:09.541Z"><meta itemprop="keywords" content="csp,security,http"><meta itemprop="discussionUrl" content="https://ponyfoo.com/articles/content-security-policy-in-express-apps#comments"><section itemprop="articleBody" class="at-corpus sp-item"><section itemprop="about" class="md-markdown at-section"><h1 id="what-is-content-security-policy"><a href="https://ponyfoo.com/articles/content-security-policy-in-express-apps#what-is-content-security-policy" class="md-heading">What is <code class="md-code md-code-inline">Content-Security-Policy</code>?</a></h1> <p>CSP is an HTTP header that helps you mitigate XSS risk by preventing resources from untrusted origins from loading. CSP comes with several different directives, each of which serves a specific purpose. For instance, the <code class="md-code md-code-inline">img-src</code> directive is used when loading images, <code class="md-code md-code-inline">script-src</code> is used when loading scripts, <code class="md-code md-code-inline">connect-src</code> is used for XHR, <code class="md-code md-code-inline">WebSocket</code> and friends, and so on.</p> <p>Each CSP directive lets you indicate which origins are trusted by using a whitelist-based approach. User agents which support CSP will avoid fetching resources that don‚Äôt match your server‚Äôs CSP directives. This means our server can determine, at a granular level, which origins are allowed for which kinds of resources.</p> <p>For instance, you might serve all of your images through the <code class="md-code md-code-inline">imgur.com</code> service, and thus you could set the header to <code class="md-code md-code-inline">Content-Security-Policy: "img-src: imgur.com;"</code> and prevent images from any origins other than <code class="md-code md-code-inline">imgur.com</code> from loading. In a similar fashion you could limit script loading to just a subdomain of your site, preventing XSS attacks from loading scripts from <code class="md-code md-code-inline">malicious.com</code> or from anywhere else you haven‚Äôt proactively approved.</p></section><section class="md-markdown at-section at-body"><h1 id="content-security-policy-in-express"><a href="https://ponyfoo.com/articles/content-security-policy-in-express-apps#content-security-policy-in-express" class="md-heading"><code class="md-code md-code-inline">Content-Security-Policy</code> in Express</a></h1> <p>If you‚Äôre using Express, it‚Äôs really simple to write maintainable CSP directives using <a href="https://github.com/helmetjs/csp" target="_blank" rel="noopener noreferrer" aria-label="helmetjs/csp on GitHub"><code class="md-code md-code-inline">helmet-csp</code></a>. To implement the <code class="md-code md-code-inline">img-src</code> rule we were talking about, we‚Äôd only have to write code link in the following snippet, and <code class="md-code md-code-inline">helmet-csp</code> will take care of adding the appropriate header to our server‚Äôs HTTP responses.</p> <pre class="md-code-block"><code class="md-code md-lang-javascript"><span class="md-code-keyword">const</span> csp = <span class="md-code-built_in">require</span>(`helmet-csp`)

app.use(csp({
  directives: {
    imgSrc: [`imgur.com`]
  }
}))
</code></pre> <p>We could also use <code class="md-code md-code-inline">'self'</code> to allow image resources from the same origin. Note that <code class="md-code md-code-inline">'self'</code> must be in quotes.</p> <pre class="md-code-block"><code class="md-code md-lang-javascript">app.use(csp({
  directives: {
    imgSrc: [`<span class="md-code-string">'self'</span>`, `imgur.com`]
  }
}))
</code></pre> <p>There is a directive called <code class="md-code md-code-inline">default-src</code> that‚Äôs used as fallback for any undeclared directives. If we set <code class="md-code md-code-inline">default-src: 'self'</code>, for example, we‚Äôd allow scripts, styles, and every other kind of resource to be loaded from the same origin.</p> <pre class="md-code-block"><code class="md-code md-lang-javascript">app.use(csp({
  directives: {
    defaultSrc: [`<span class="md-code-string">'self'</span>`],
    imgSrc: [`<span class="md-code-string">'self'</span>`, `imgur.com`]
  }
}))
</code></pre> <p>Keep in mind that <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/default-src" target="_blank" rel="noopener noreferrer" aria-label="Read the documentation about the &#39;default-src&#39; directive on MDN."><code class="md-code md-code-inline">default-src</code></a> <strong>isn‚Äôt inherited</strong> by other declared rules, meaning that if we now removed <code class="md-code md-code-inline">'self'</code> from <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/img-src" target="_blank" rel="noopener noreferrer" aria-label="Read the documentation about the &#39;img-src&#39; directive on MDN."><code class="md-code md-code-inline">img-src</code></a>, only images from <code class="md-code md-code-inline">imgur.com</code> would be allowed.</p> <p>There are <strong>many</strong> different directives we can set. What follows is a table <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy#Directives" target="_blank" rel="noopener noreferrer" aria-label="Content-Security-Policy Directives">based off of MDN documentation</a>, containing just the 15 most relevant rules. As you can see, we weren‚Äôt exaggerating when we said CSP allows us to determine where resources can be loaded from <strong>on a granular level</strong>. We can make our CSP header as complicated as we want it to be, with directives ranging from simple rules such as where images should be allowed to load from with <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/img-src" target="_blank" rel="noopener noreferrer" aria-label="Read the documentation about the &#39;img-src&#39; directive on MDN."><code class="md-code md-code-inline">img-src</code></a>, to more severe ones like blocking all mixed content or restricting how the page works using the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/sandbox" target="_blank" rel="noopener noreferrer" aria-label="Read the documentation about the &#39;sandbox&#39; directive on MDN."><code class="md-code md-code-inline">sandbox</code></a> directive.</p> <table> <thead> <tr> <th>Directive</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/block-all-mixed-content" target="_blank" rel="noopener noreferrer" aria-label="Read the documentation about the &#39;block-all-mixed-content&#39; directive on MDN."><code class="md-code md-code-inline">block-all-mixed-content</code></a></td> <td>Prevents loading any assets using HTTP when the page is loaded using HTTPS.</td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/child-src" target="_blank" rel="noopener noreferrer" aria-label="Read the documentation about the &#39;child-src&#39; directive on MDN."><code class="md-code md-code-inline">child-src</code></a></td> <td>Defines the valid sources for web workers and nested browsing contexts loaded using elements such as <code class="md-code md-code-inline">&lt;frame&gt;</code> and <code class="md-code md-code-inline">&lt;iframe&gt;</code>.</td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/connect-src" target="_blank" rel="noopener noreferrer" aria-label="Read the documentation about the &#39;connect-src&#39; directive on MDN."><code class="md-code md-code-inline">connect-src</code></a></td> <td>Restricts the URLs which can be loaded using script interfaces</td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/default-src" target="_blank" rel="noopener noreferrer" aria-label="Read the documentation about the &#39;default-src&#39; directive on MDN."><code class="md-code md-code-inline">default-src</code></a></td> <td>Serves as a fallback for the other fetch directives.</td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/font-src" target="_blank" rel="noopener noreferrer" aria-label="Read the documentation about the &#39;font-src&#39; directive on MDN."><code class="md-code md-code-inline">font-src</code></a></td> <td>Specifies valid sources for fonts loaded using <code class="md-code md-code-inline">@font-face</code>.</td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/frame-src" target="_blank" rel="noopener noreferrer" aria-label="Read the documentation about the &#39;frame-src&#39; directive on MDN."><code class="md-code md-code-inline">frame-src</code></a></td> <td>Specifies valid sources for nested browsing contexts loading using elements such as <code class="md-code md-code-inline">&lt;frame&gt;</code> and <code class="md-code md-code-inline">&lt;iframe&gt;</code>.</td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/img-src" target="_blank" rel="noopener noreferrer" aria-label="Read the documentation about the &#39;img-src&#39; directive on MDN."><code class="md-code md-code-inline">img-src</code></a></td> <td>Specifies valid sources of images and favicons.</td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/media-src" target="_blank" rel="noopener noreferrer" aria-label="Read the documentation about the &#39;media-src&#39; directive on MDN."><code class="md-code md-code-inline">media-src</code></a></td> <td>Specifies valid sources for loading media using the <code class="md-code md-code-inline">&lt;audio&gt;</code> and <code class="md-code md-code-inline">&lt;video&gt;</code> elements.</td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/object-src" target="_blank" rel="noopener noreferrer" aria-label="Read the documentation about the &#39;object-src&#39; directive on MDN."><code class="md-code md-code-inline">object-src</code></a></td> <td>Specifies valid sources for the <code class="md-code md-code-inline">&lt;object&gt;</code>, <code class="md-code md-code-inline">&lt;embed&gt;</code>, and <code class="md-code md-code-inline">&lt;applet&gt;</code> elements.</td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/report-uri" target="_blank" rel="noopener noreferrer" aria-label="Read the documentation about the &#39;report-uri&#39; directive on MDN."><code class="md-code md-code-inline">report-uri</code></a></td> <td>Instructs the user agent to report attempts to violate the Content Security Policy. These violation reports consist of JSON documents sent via an HTTP POST request to the specified URI.</td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/require-sri-for" target="_blank" rel="noopener noreferrer" aria-label="Read the documentation about the &#39;require-sri-for&#39; directive on MDN."><code class="md-code md-code-inline">require-sri-for</code></a></td> <td>Requires the use of SRI for scripts or styles on the page.</td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/sandbox" target="_blank" rel="noopener noreferrer" aria-label="Read the documentation about the &#39;sandbox&#39; directive on MDN."><code class="md-code md-code-inline">sandbox</code></a></td> <td>Enables a sandbox for the requested resource similar to the <code class="md-code md-code-inline">&lt;iframe&gt;</code> sandbox attribute.</td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/script-src" target="_blank" rel="noopener noreferrer" aria-label="Read the documentation about the &#39;script-src&#39; directive on MDN."><code class="md-code md-code-inline">script-src</code></a></td> <td>Specifies valid sources for JavaScript.</td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/style-src" target="_blank" rel="noopener noreferrer" aria-label="Read the documentation about the &#39;style-src&#39; directive on MDN."><code class="md-code md-code-inline">style-src</code></a></td> <td>Specifies valid sources for stylesheets.</td> </tr> <tr> <td><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/upgrade-insecure-requests" target="_blank" rel="noopener noreferrer" aria-label="Read the documentation about the &#39;upgrade-insecure-requests&#39; directive on MDN."><code class="md-code md-code-inline">upgrade-insecure-requests</code></a></td> <td>Instructs user agents to treat all of a site‚Äôs insecure URLs (those served over HTTP) as though they have been replaced with secure URLs (those served over HTTPS). This directive is intended for web sites with large numbers of insecure legacy URLs that need to be rewritten.</td> </tr> </tbody> </table> <p>Granted, the above table can feel intimidating. To get started with CSP, however, we don‚Äôt need to list every single rule. Generally speaking, a good idea is to set a <code class="md-code md-code-inline">default-src</code> of <code class="md-code md-code-inline">'self'</code> and then whitelist other origins to allow specific resources to load. Using <code class="md-code md-code-inline">report-only</code> is a great way of finding out what those other resources could be.</p> <h1 id="to-get-started-let-s-use-report-only"><a href="https://ponyfoo.com/articles/content-security-policy-in-express-apps#to-get-started-let-s-use-report-only" class="md-heading">To get started, let‚Äôs use <code class="md-code md-code-inline">report-only</code></a></h1> <p>The <code class="md-code md-code-inline">Content-Security-Policy-Report-Only</code> header is identical to the <code class="md-code md-code-inline">Content-Security-Policy</code> header, except that it behaves like a dry run. The policy won‚Äôt be enforced, <em>‚Äì resources will continue to load as they were ‚Äì</em> but the configured <code class="md-code md-code-inline">report-uri</code> will be requested with a <code class="md-code md-code-inline">POST</code> message and a JSON payload.</p> <p>I‚Äôll be using the <a href="https://github.com/winstonjs/winston" target="_blank" rel="noopener noreferrer" aria-label="winstonjs/winston on GitHub"><code class="md-code md-code-inline">winston</code></a> logger to persist log messages for the CSP report, but you can use anything you‚Äôd like. Odds are, you already have some sort of logging solution in place <em>‚Äì use that!</em></p> <pre class="md-code-block"><code class="md-code md-lang-javascript"><span class="md-code-keyword">const</span> winston = <span class="md-code-built_in">require</span>(`winston`)

app.use(csp({
  directives: {
    defaultSrc: [`<span class="md-code-string">'self'</span>`],
    reportUri: `/api/csp/report`
  },
  reportOnly: <span class="md-code-literal">true</span>
}))

app.post(`/api/csp/report`, (req, res) =&gt; {
  winston.warn(`CSP header violation`, req.body[`csp-report`])
  res.status(<span class="md-code-number">204</span>).end()
})
</code></pre> <p>Once you set up CSP reporting, your server will start logging reports of every single resource that would‚Äôve been blocked by your CSP header. As the days pass, you‚Äôll collect considerable amounts of data on the resources CSP would block.</p> <p>You could fix the violations by relaxing your CSP directives, for example by adding origins you‚Äôll allow images to be loaded from; or by changing how your site is implemented so that the resources that would have been blocked by the CSP directive aren‚Äôt requested anymore.</p> <p>Keep adding directives to your CSP header without removing <code class="md-code md-code-inline">reportOnly: true</code> from your <code class="md-code md-code-inline">helmet-csp</code> configuration. As you tweak your header, you should see the amount of reports shrinking to a point where it‚Äôll be safe to remove the <code class="md-code md-code-inline">reportOnly: true</code> option. At this point, your CSP header will be in effect and requests for resources from untrusted origins will be blocked.</p> <p>Generally speaking, there‚Äôs two hurdles to overcome when setting up a CSP header for production use.</p> <p>Ads served by an ad network tend to load third party scripts, loading images, styles, and scripts from an assortment of different origins. Unless the ad network offers documentation on how to set up your CSP header to allow them to serve advertisements unimpeded, it can be hard to detect every origin casually in order to whitelist them. This is one of the reasons why the ‚Äúreport-only first‚Äù approach is recommended.</p> <p>Inline scripts and inline styles can also be a hassle. Any occurrence of <code class="md-code md-code-inline">onclick</code> handlers directly in your HTML code, inline script tags such as your typical Google Analytics snippet, or inline styles such as those recommended to optimize <a href="https://ponyfoo.com/articles/critical-path-performance-optimization" aria-label="Critical Path Performance Optimization at Pony Foo">critical rendering path performance</a> will be blocked by CSP unless you add the shame-inducing <code class="md-code md-code-inline">'unsafe-inline'</code> source to <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/script-src" target="_blank" rel="noopener noreferrer" aria-label="Read the documentation about the &#39;script-src&#39; directive on MDN."><code class="md-code md-code-inline">script-src</code></a> and <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/style-src" target="_blank" rel="noopener noreferrer" aria-label="Read the documentation about the &#39;style-src&#39; directive on MDN."><code class="md-code md-code-inline">style-src</code></a> directives, respectively. The same goes with<code class="md-code md-code-inline">'unsafe-eval'</code>, which whitelists JavaScript code such as <code class="md-code md-code-inline">eval(`code`)</code>, <code class="md-code md-code-inline">setTimeout(`code`)</code> or <code class="md-code md-code-inline">new Function(`code`)</code>._</p> <h1 id="inlining-safely-using-a-nonce"><a href="https://ponyfoo.com/articles/content-security-policy-in-express-apps#inlining-safely-using-a-nonce" class="md-heading">Inlining safely using a <code class="md-code md-code-inline">nonce</code></a></h1> <p>You probably have inline styles and scripts like the Google Analytics snippet we‚Äôve mentioned above. To whitelist these snippets without turning on the <code class="md-code md-code-inline">'unsafe-inline'</code> rule, we can use a nonce. A nonce is an unique code we generate for every request, using a module such as <a href="https://github.com/kelektiv/node-uuid" target="_blank" rel="noopener noreferrer" aria-label="kelektiv/node-uuid on GitHub"><code class="md-code md-code-inline">uuid</code></a>.</p> <p>In the following piece of code, we generate a nonce for every request.</p> <pre class="md-code-block"><code class="md-code md-lang-javascript"><span class="md-code-keyword">const</span> uuid = <span class="md-code-built_in">require</span>(`uuid`)

app.use((req, res, next) =&gt; {
  res.locals.nonce = uuid.v4()
  next()
})
</code></pre> <p>We then tell the CSP directive what the nonce for the current request is. Any inline scripts that don‚Äôt have the same nonce in a <code class="md-code md-code-inline">nonce</code> attribute will be blocked.</p> <pre class="md-code-block"><code class="md-code md-lang-javascript"><span class="md-code-keyword">const</span> csp = <span class="md-code-built_in">require</span>(`helmet-csp`)

app.use(csp({
  directives: {
    defaultSrc: [`<span class="md-code-string">'self'</span>`],
    scriptSrc: [`<span class="md-code-string">'self'</span>`, (req, res) =&gt; `<span class="md-code-string">'nonce-${ res.locals.nonce }'</span>`]
  }
}))
</code></pre> <p>Lastly, we apply the nonce as an attribute for any inline scripts and styles we have. This tells CSP-compliant browsers that the script is safe to execute.</p> <pre class="md-code-block"><code class="md-code md-lang-javascript">// in the real world, this would be in your view engine:
app.use((req, res) =&gt; {
  res.end(`&lt;script nonce='${ res.locals.nonce }'&gt;alert('whitelisted!')&lt;/script&gt;`)
})
</code></pre> <p>You can repeat the process for inline styles, but using <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/style-src" target="_blank" rel="noopener noreferrer" aria-label="Read the documentation about the &#39;style-src&#39; directive on MDN."><code class="md-code md-code-inline">style-src</code></a> and <code class="md-code md-code-inline">&lt;style nonce='...'&gt;</code>.</p> <h1 id="closing-the-loop-with-upgrade-insecure-requests"><a href="https://ponyfoo.com/articles/content-security-policy-in-express-apps#closing-the-loop-with-upgrade-insecure-requests" class="md-heading">Closing the loop with <code class="md-code md-code-inline">upgrade-insecure-requests</code></a></h1> <p>Using CSP‚Äôs <code class="md-code md-code-inline">upgrade-insecure-requests</code> directive, we could have the user agent automatically upgrade HTTP requests to HTTPS, effectively transforming code like this:</p> <pre class="md-code-block"><code class="md-code md-lang-xml"><span class="md-code-tag">&lt;<span class="md-code-title">img</span> <span class="md-code-attribute">src</span>=<span class="md-code-value">'<mark class="md-mark md-code-mark">http://</mark>cats.com/hairy-cat.png'</span> /&gt;</span>
</code></pre> <p>Into its secure counterpart:</p> <pre class="md-code-block"><code class="md-code md-lang-xml"><span class="md-code-tag">&lt;<span class="md-code-title">img</span> <span class="md-code-attribute">src</span>=<span class="md-code-value">'<mark class="md-mark md-code-mark">https://</mark>cats.com/hairy-cat.png'</span> /&gt;</span>
</code></pre> <p>Enabling this behavior in <code class="md-code md-code-inline">helmet-csp</code> is merely a matter of setting <code class="md-code md-code-inline">upgradeInsecureRequests: true</code>.</p> <pre class="md-code-block"><code class="md-code md-lang-javascript">app.use(csp({
  directives: {
    upgradeInsecureRequests: <span class="md-code-literal">true</span>
  }
}))
</code></pre> <h1 id="csp-in-express-by-example"><a href="https://ponyfoo.com/articles/content-security-policy-in-express-apps#csp-in-express-by-example" class="md-heading">CSP in Express, by Example</a></h1> <p>Here‚Äôs an example of how we compose the CSP header for Pony Foo. There‚Äôs quite a few whitelisted external services, and we weren‚Äôt able to completely get rid of inline styles, but it‚Äôs a good start!</p> <pre class="md-code-block"><code class="md-code md-lang-javascript"><span class="md-code-keyword">const</span> csp = <span class="md-code-built_in">require</span>(`helmet-csp`)
<span class="md-code-keyword">const</span> uuid = <span class="md-code-built_in">require</span>(`uuid`)
<span class="md-code-keyword">const</span> env = <span class="md-code-built_in">require</span>(`./env`)
<span class="md-code-keyword">const</span> authority = env(`AUTHORITY`)
<span class="md-code-keyword">const</span> authorityIsSecure = authority.startsWith(`https`)
<span class="md-code-keyword">const</span> authorityProtocol = authorityIsSecure ? `https` : `http`

<span class="md-code-function"><span class="md-code-keyword">function</span> <span class="md-code-title">generateNonce</span><span class="md-code-params">(req, res, next)</span> </span>{
  <span class="md-code-keyword">const</span> rhyphen = <span class="md-code-regexp">/-/g</span>
  res.locals.nonce = uuid.v4().replace(rhyphen, ``)
  next()
}

<span class="md-code-function"><span class="md-code-keyword">function</span> <span class="md-code-title">getNonce</span> <span class="md-code-params">(req, res)</span> </span>{
  <span class="md-code-keyword">return</span> `<span class="md-code-string">'nonce-${ res.locals.nonce }'</span>`
}

<span class="md-code-function"><span class="md-code-keyword">function</span> <span class="md-code-title">getDirectives</span> <span class="md-code-params">()</span> </span>{
  <span class="md-code-keyword">const</span> self = `<span class="md-code-string">'self'</span>`
  <span class="md-code-keyword">const</span> unsafeInline = `<span class="md-code-string">'unsafe-inline'</span>`
  <span class="md-code-keyword">const</span> scripts = [
    `https:<span class="md-code-comment">//www.google-analytics.com/`,</span>
    `https:<span class="md-code-comment">//maps.googleapis.com/`,</span>
    `https:<span class="md-code-comment">//static.getclicky.com/`,</span>
    `https:<span class="md-code-comment">//in.getclicky.com/`,</span>
    `https:<span class="md-code-comment">//cdn.carbonads.com/`,</span>
    `http:<span class="md-code-comment">//srv.carbonads.net/`,</span>
    `${ authorityProtocol }:<span class="md-code-comment">//adn.fusionads.net/`,</span>
    `https:<span class="md-code-comment">//platform.twitter.com/`,</span>
    `https:<span class="md-code-comment">//assets.codepen.io/`,</span>
    `https:<span class="md-code-comment">//cdn.syndication.twimg.com/`</span>
  ]
  <span class="md-code-keyword">const</span> styles = [
    `https:<span class="md-code-comment">//fonts.googleapis.com/`,</span>
    `https:<span class="md-code-comment">//platform.twitter.com/`</span>
  ]
  <span class="md-code-keyword">const</span> fonts = [
    `https:<span class="md-code-comment">//fonts.gstatic.com/`</span>
  ]
  <span class="md-code-keyword">const</span> frames = [
    `https:<span class="md-code-comment">//www.youtube.com/`,</span>
    `https:<span class="md-code-comment">//speakerdeck.com/`,</span>
    `https:<span class="md-code-comment">//player.vimeo.com/`,</span>
    `https:<span class="md-code-comment">//syndication.twitter.com/`,</span>
    `https:<span class="md-code-comment">//codepen.io/`</span>
  ]
  <span class="md-code-keyword">const</span> images = [
    `https:`,
    `data:`
  ]
  <span class="md-code-keyword">const</span> connect = [
    `https:<span class="md-code-comment">//api.github.com/`,</span>
    `https:<span class="md-code-comment">//maps.googleapis.com/`</span>
  ]

  <span class="md-code-keyword">return</span> {
    defaultSrc: [self],
    scriptSrc: [self, getNonce, ...scripts],
    styleSrc: [self, unsafeInline, ...styles],
    fontSrc: [self, ...fonts],
    frameSrc: [self, ...frames],
    connectSrc: [self, ...connect],
    imgSrc: [self, ...images],
    objectSrc: [self],

    <span class="md-code-comment">// breaks pdf in chrome:</span>
    <span class="md-code-comment">// https://bugs.chromium.org/p/chromium/issues/detail?id=413851</span>
    <span class="md-code-comment">// sandbox: [`allow-forms`, `allow-scripts`, `allow-same-origin`],</span>

    upgradeInsecureRequests: authorityIsSecure,
    reportUri: `/api/csp/report`
  }
}

app.use(generateNonce)
app.use(csp({
  directives: getDirectives()
}))
</code></pre> <h1 id="further-reading"><a href="https://ponyfoo.com/articles/content-security-policy-in-express-apps#further-reading" class="md-heading">Further Reading</a></h1> <ul> <li><a href="https://developer.mozilla.org/en-US/docs/Web/Security/Subresource_Integrity" target="_blank" rel="noopener noreferrer" aria-label="Subresource Integrity on MDN">Subresource Integrity</a> ‚Äì a better way of trusting resources served by our CDN</li> <li><a href="https://content-security-policy.com/" target="_blank" rel="noopener noreferrer" aria-label="Content Security Policy Quick Reference Guide">Content-Security-Policy.com</a> ‚Äì a good go-to resource which summarizes a lot of advice around CSP</li> <li><a href="https://githubengineering.com/githubs-csp-journey/" target="_blank" rel="noopener noreferrer" aria-label="GitHub&#39;s CSP journey">GitHub‚Äôs CSP journey</a> ‚Äì where they explain the steps they took in implementing CSP</li> <li><a href="https://githubengineering.com/githubs-post-csp-journey/" target="_blank" rel="noopener noreferrer" aria-label="GitHub&#39;s post-CSP journey">GitHub‚Äôs post-CSP journey</a> ‚Äì where they go further and dive into more advanced tactics to zero in on XSS attack mitigation</li> </ul> <p>If you liked this article, consider subscribing to <a href="https://ponyfoo.com/weekly" aria-label="Pony Foo Weekly Email Newsletter">Pony Foo Weekly</a>, our periodic email newsletter on front-end development! <img class="tj-emoji" draggable="false" alt="üíå" src="./Content-Security-Policy in Express apps_files/1f48c.png"></p></section></section><footer class="at-siblings an-siblings uv-clearfix"><a href="https://ponyfoo.com/articles/setting-up-angular-2-development-environment" rel="prev" aria-label="Read the previous article!" class="lk-rainbows an-anchor an-prev"><span>¬´ </span><span class="an-title md-markdown">Setting up an Angular 2 Development Environment</span></a><a href="https://ponyfoo.com/articles/const-variables-not-immutable" rel="next" aria-label="Read the next article!" class="lk-rainbows an-anchor an-next"><span class="an-title md-markdown">Variables declared using <code class="md-code md-code-inline">const</code> are not immutable</span><span> ¬ª</span></a></footer></article><form action="https://ponyfoo.com/api/subscribers" method="post" name="subscribe" class="ly-section ss-container at-subscribe wt-cta"><div class="ss-label">Liked the article? Subscribe below to get an email when new articles come out! Also, follow <a href="https://twitter.com/ponyfoo" target="_blank" rel="noopener noreferrer" class="lk-link lk-twitter">@ponyfoo</a> on Twitter and <a href="https://facebook.com/ponyfoo" target="_blank" rel="noopener noreferrer" class="lk-link lk-facebook">@ponyfoo</a> on Facebook.</div><div class="ss-label ss-unsubscribe"><sub><span>One-click unsubscribe, anytime.</span><span> </span><a href="https://ponyfoo.com/subscribe" aria-label="Subscribe to our mailing list" class="lk-link">Learn more.</a></sub></div><noscript><input name="verify" value="Promise not to be a bot? Clear this field!" placeholder="This field is only for tricksters‚Ä¶" class="uv-verify"/></noscript><input type="hidden" name="source" value="article" class="ss-source"><input placeholder="example@ponyfoo.com" name="email" type="email" class="wt-input ss-input"><span aria-label="As easy as clicking this button and confirming via email!" class="wt-submit"><button type="submit" class="bt-button bt-pink ss-button">Subscribe</button></span></form><section id="comments" class="mm-comments"><h2 class="mm-heading"><span class="mm-heading-text">Comments</span></h2><footer class="mm-footer"><div class="mm-footer-text">The comments section is now closed.</div></footer></section></div><aside class="de-sidebar de-column"><section class="ca-container"><div class="aaf-container"><div class="aaf-loading"><span>A relevant ad will be displayed here soon. These ads help pay for my hosting.</span></div><div class="aaf-content"><div class="aaf-blocked"><span>Please consider disabling your ad blocker on Pony Foo. These ads help pay for my hosting.</span><span> </span><div class="aaf-support"><span>You can support Pony Foo directly through </span><a href="https://ponyfoo.com/s/patreon" target="_blank" rel="noopener noreferrer" class="lk-link">Patreon</a><span> or via </span><a href="https://ponyfoo.com/s/paypal" target="_blank" rel="noopener noreferrer" class="lk-link">PayPal</a><span>.</span></div></div><script async="" src="./Content-Security-Policy in Express apps_files/carbon.js" id="_carbonads_js"></script><div id="carbonads"><span><span class="carbon-wrap"><a href="https://srv.carbonads.net/ads/click/x/GTND42JJCKADPK3YCT7LYKQNC6BD6K7LCKYD4Z3JCYYIVKJICYAI653KFTYD6K7JFTYIP5QJCTSDK5QYC6BIVKQKC6SD4K7YCVAIKK3EHJNCLSIZ?segment=placement:ponyfoocom;" class="carbon-img" target="_blank" rel="noopener sponsored"><img src="./Content-Security-Policy in Express apps_files/1525189943-38523.png" alt="ads via Carbon" border="0" height="100" width="130" style="max-width: 130px;"></a><a href="https://srv.carbonads.net/ads/click/x/GTND42JJCKADPK3YCT7LYKQNC6BD6K7LCKYD4Z3JCYYIVKJICYAI653KFTYD6K7JFTYIP5QJCTSDK5QYC6BIVKQKC6SD4K7YCVAIKK3EHJNCLSIZ?segment=placement:ponyfoocom;" class="carbon-text" target="_blank" rel="noopener sponsored">Limited time offer: Get 10 free Adobe Stock images.</a></span><a href="http://carbonads.net/?utm_source=ponyfoocom&amp;utm_medium=ad_via_link&amp;utm_campaign=in_unit&amp;utm_term=carbon" class="carbon-poweredby" target="_blank" rel="noopener sponsored">ads via Carbon</a></span></div></div></div></section><form action="https://ponyfoo.com/api/subscribers" method="post" name="subscribe" class="ly-section ss-container de-subscribe"><div class="ss-label"><strong>Subscribe</strong><span> to our mailing list and be the first to know when new articles come out!</span></div><div class="ss-label ss-unsubscribe"><sub><span>One-click unsubscribe, anytime.</span><span> </span><a href="https://ponyfoo.com/subscribe" aria-label="Subscribe to our mailing list" class="lk-link">Learn more.</a></sub></div><noscript><input name="verify" value="Promise not to be a bot? Clear this field!" placeholder="This field is only for tricksters‚Ä¶" class="uv-verify"/></noscript><input type="hidden" name="source" value="sidebar" class="ss-source"><input placeholder="example@ponyfoo.com" name="email" type="email" class="de-input bt-inline-rest ss-input"><span aria-label="As easy as clicking this button and confirming via email!" class="de-button"><button type="submit" class="bt-button bt-inline bt-pink ss-button">Subscribe</button></span></form><div class="de-poll"><div id="sidebar-poll-view-rendering-frameworks" data-slug="view-rendering-frameworks" class="pll-poll-view"><div style="" class="pll-title"><h3 class="pll-title-heading"><div class="md-markdown md-markdown-inline"><p>What‚Äôs your favorite view rendering framework? <img class="tj-emoji" draggable="false" alt="üåÖ" src="./Content-Security-Policy in Express apps_files/1f305.png"></p> </div></h3></div><div class="pll-description md-markdown"></div><div class="pll-choices"><div class="pll-choice"><div class="pll-vote-container"><span class="pll-vote pll-expired"><span class="pll-choice-icon ck-synthetic-checkbox">‚úì</span><span class="pll-choice-content"><span class="pll-choice-title md-markdown md-markdown-inline"><p>Angular <img class="tj-emoji" draggable="false" alt="ü¶ï" src="./Content-Security-Policy in Express apps_files/1f995.png"></p> </span><div class="pll-choice-description md-markdown"></div></span></span></div><div class="pll-score uv-hidden"><svg class="pll-score-compare"><line x1="0%" y1="0%" x2="100%" y2="100%" class="pll-score-compare-bg"></line><line x1="0%" y1="0%" x2="12.76%" y2="100%" class="pll-score-compare-fg"></line></svg><div class="pll-score-text"><span>12.76%</span><span> (117 votes)</span></div></div></div><div class="pll-choice"><div class="pll-vote-container"><span class="pll-vote pll-expired"><span class="pll-choice-icon ck-synthetic-checkbox">‚úì</span><span class="pll-choice-content"><span class="pll-choice-title md-markdown md-markdown-inline"><p>Vue <img class="tj-emoji" draggable="false" alt="ü§≥" src="./Content-Security-Policy in Express apps_files/1f933.png"></p> </span><div class="pll-choice-description md-markdown"></div></span></span></div><div class="pll-score uv-hidden"><svg class="pll-score-compare"><line x1="0%" y1="0%" x2="100%" y2="100%" class="pll-score-compare-bg"></line><line x1="0%" y1="0%" x2="23.99%" y2="100%" class="pll-score-compare-fg"></line></svg><div class="pll-score-text"><span>23.99%</span><span> (220 votes)</span></div></div></div><div class="pll-choice"><div class="pll-vote-container"><span class="pll-vote pll-expired"><span class="pll-choice-icon ck-synthetic-checkbox">‚úì</span><span class="pll-choice-content"><span class="pll-choice-title md-markdown md-markdown-inline"><p>React <img class="tj-emoji" draggable="false" alt="‚ùÑÔ∏è" src="./Content-Security-Policy in Express apps_files/2744.png"></p> </span><div class="pll-choice-description md-markdown"></div></span></span></div><div class="pll-score uv-hidden"><svg class="pll-score-compare"><line x1="0%" y1="0%" x2="100%" y2="100%" class="pll-score-compare-bg"></line><line x1="0%" y1="0%" x2="49.18%" y2="100%" class="pll-score-compare-fg"></line></svg><div class="pll-score-text"><span>49.18%</span><span> (451 votes)</span></div></div></div><div class="pll-choice"><div class="pll-vote-container"><span class="pll-vote pll-expired"><span class="pll-choice-icon ck-synthetic-checkbox">‚úì</span><span class="pll-choice-content"><span class="pll-choice-title md-markdown md-markdown-inline"><p>Ember <img class="tj-emoji" draggable="false" alt="üî•" src="./Content-Security-Policy in Express apps_files/1f525.png"></p> </span><div class="pll-choice-description md-markdown"></div></span></span></div><div class="pll-score uv-hidden"><svg class="pll-score-compare"><line x1="0%" y1="0%" x2="100%" y2="100%" class="pll-score-compare-bg"></line><line x1="0%" y1="0%" x2="4.14%" y2="100%" class="pll-score-compare-fg"></line></svg><div class="pll-score-text"><span>4.14%</span><span> (38 votes)</span></div></div></div><div class="pll-choice"><div class="pll-vote-container"><span class="pll-vote pll-expired"><span class="pll-choice-icon ck-synthetic-checkbox">‚úì</span><span class="pll-choice-content"><span class="pll-choice-title md-markdown md-markdown-inline"><p>Polymer <img class="tj-emoji" draggable="false" alt="ü§Ω‚Äç‚ôÇÔ∏è" src="./Content-Security-Policy in Express apps_files/1f93d-200d-2642-fe0f.png"></p> </span><div class="pll-choice-description md-markdown"><p>It‚Äôs a thing!</p> </div></span></span></div><div class="pll-score uv-hidden"><svg class="pll-score-compare"><line x1="0%" y1="0%" x2="100%" y2="100%" class="pll-score-compare-bg"></line><line x1="0%" y1="0%" x2="9.92%" y2="100%" class="pll-score-compare-fg"></line></svg><div class="pll-score-text"><span>9.92%</span><span> (91 votes)</span></div></div></div></div><div class="pll-actions"><div><a aria-label="Click here to reveal the score!" class="pll-show-results bt-button bt-lilly bt-small">Show results</a></div><div class="pll-right-actions"><div class="pll-timing uv-hidden"><span class="pll-created"><span>917</span><span> </span><span>votes</span><span> since </span><time datetime="2018-10-19T15:44:38.040Z" aria-label="03:44 PM, Oct 19, 2018 (GMT)">2 years ago</time></span><div class="pll-ended">This poll has ended.</div></div><div class="pll-see-more-polls"><a href="https://ponyfoo.com/polls" aria-label="You get a poll, you get a poll, everyone gets appalled by my poor jokes!" class="lk-link lk-gray">See more polls</a></div></div></div></div></div><form id="search" action="https://ponyfoo.com/articles/search" method="get" name="search" class="ly-section de-search"><div class="de-search-label"><sub>Search for articles</sub></div><input placeholder="e.g JavaScript" name="terms" class="de-input bt-inline-rest sr-input"><span aria-label="Pro Tip: use &quot;[js]&quot; to search for article tags!" class="de-button"><button type="submit" class="bt-button bt-inline bt-pink sr-button">Search</button></span></form><article><section class="ra-container ra-popular"><header><h3 class="ra-title">Greatest Hits</h3></header><ul class="ra-list"><li><a href="https://ponyfoo.com/articles/understanding-javascript-async-await" class="ra-link lk-link lk-link-to-green lk-visitor-before lk-visitor-before-no-underline lk-visitor-large md-markdown md-markdown-inline">Understanding JavaScript‚Äôs async await</a></li><li><a href="https://ponyfoo.com/articles/es6" class="ra-link lk-link lk-link-to-green lk-visitor-before lk-visitor-before-no-underline lk-visitor-large md-markdown md-markdown-inline">ES6 Overview in 350 Bullet Points</a></li><li><a href="https://ponyfoo.com/articles/json-web-tokens-vs-session-cookies" class="ra-link lk-link lk-link-to-green lk-visitor-before lk-visitor-before-no-underline lk-visitor-large md-markdown md-markdown-inline">JSON Web Tokens vs. Session Cookies: In Practice</a></li><li><a href="https://ponyfoo.com/articles/es6-promises-in-depth" class="ra-link lk-link lk-link-to-green lk-visitor-before lk-visitor-before-no-underline lk-visitor-large md-markdown md-markdown-inline">ES6 Promises in Depth</a></li><li><a href="https://ponyfoo.com/articles/es6-destructuring-in-depth" class="ra-link lk-link lk-link-to-green lk-visitor-before lk-visitor-before-no-underline lk-visitor-large md-markdown md-markdown-inline">ES6 JavaScript Destructuring in Depth</a></li><li><a href="https://ponyfoo.com/articles/choose-grunt-gulp-or-npm" class="ra-link lk-link lk-link-to-green lk-visitor-before lk-visitor-before-no-underline lk-visitor-large md-markdown md-markdown-inline">Choose: Grunt, Gulp, or npm?</a></li><li><a href="https://ponyfoo.com/articles/es6-modules-in-depth" class="ra-link lk-link lk-link-to-green lk-visitor-before lk-visitor-before-no-underline lk-visitor-large md-markdown md-markdown-inline">ES6 Modules in Depth</a></li><li><a href="https://ponyfoo.com/articles/es6-proxies-in-depth" class="ra-link lk-link lk-link-to-green lk-visitor-before lk-visitor-before-no-underline lk-visitor-large md-markdown md-markdown-inline">ES6 Proxies in Depth</a></li><li><a href="https://ponyfoo.com/articles/null-propagation-operator" class="ra-link lk-link lk-link-to-green lk-visitor-before lk-visitor-before-no-underline lk-visitor-large md-markdown md-markdown-inline">Null Propagation Operator in JavaScript</a></li><li><a href="https://ponyfoo.com/articles/binding-methods-to-class-instance-objects" class="ra-link lk-link lk-link-to-green lk-visitor-before lk-visitor-before-no-underline lk-visitor-large md-markdown md-markdown-inline">Binding Methods to Class Instance Objects</a></li><li><a href="https://ponyfoo.com/articles/why-i-write-plain-javascript-modules" class="ra-link lk-link lk-link-to-green lk-visitor-before lk-visitor-before-no-underline lk-visitor-large md-markdown md-markdown-inline">Why I Write Plain JavaScript Modules</a></li><li><a href="https://ponyfoo.com/articles/es6-template-strings-in-depth" class="ra-link lk-link lk-link-to-green lk-visitor-before lk-visitor-before-no-underline lk-visitor-large md-markdown md-markdown-inline">ES6 Template Literals in Depth</a></li><li><a href="https://ponyfoo.com/articles/stop-breaking-the-web" class="ra-link lk-link lk-link-to-green lk-visitor-before lk-visitor-before-no-underline lk-visitor-large md-markdown md-markdown-inline">Stop Breaking the Web</a></li><li><a href="https://ponyfoo.com/articles/es6-spread-and-butter-in-depth" class="ra-link lk-link lk-link-to-green lk-visitor-before lk-visitor-before-no-underline lk-visitor-large md-markdown md-markdown-inline">ES6 Spread and Butter in Depth</a></li><li><a href="https://ponyfoo.com/articles/javascript-developer-survey-results" class="ra-link lk-link lk-link-to-green lk-visitor-before lk-visitor-before-no-underline lk-visitor-large md-markdown md-markdown-inline">JavaScript Developer Survey Results</a></li><li><a href="https://ponyfoo.com/articles/es6-reflection-in-depth" class="ra-link lk-link lk-link-to-green lk-visitor-before lk-visitor-before-no-underline lk-visitor-large md-markdown md-markdown-inline">ES6 Reflection in Depth</a></li><li><a href="https://ponyfoo.com/articles/setting-up-angular-2-development-environment" class="ra-link lk-link lk-link-to-green lk-visitor-before lk-visitor-before-no-underline lk-visitor-large md-markdown md-markdown-inline">Setting up an Angular 2 Development Environment</a></li><li><a href="https://ponyfoo.com/articles/es6-maps-in-depth" class="ra-link lk-link lk-link-to-green lk-visitor-before lk-visitor-before-no-underline lk-visitor-large md-markdown md-markdown-inline">ES6 Maps in Depth</a></li></ul></section><section class="ra-container ra-similar"><header><h3 class="ra-title">Similar Articles</h3></header><ul class="ra-list"><li><a href="https://ponyfoo.com/articles/more-es6-proxy-traps-in-depth" aria-label="Read the article!" class="ra-link lk-link lk-link-to-green lk-visitor-before lk-visitor-before-no-underline lk-visitor-large md-markdown md-markdown-inline">More ES6 Proxy Traps in Depth</a></li><li><a href="https://ponyfoo.com/articles/es6-math-additions-in-depth" aria-label="Read the article!" class="ra-link lk-link lk-link-to-green lk-visitor-before lk-visitor-before-no-underline lk-visitor-large md-markdown md-markdown-inline">ES6 Math Additions in Depth</a></li><li><a href="https://ponyfoo.com/articles/es6-object-changes-in-depth" aria-label="Read the article!" class="ra-link lk-link lk-link-to-green lk-visitor-before lk-visitor-before-no-underline lk-visitor-large md-markdown md-markdown-inline">ES6 Object Changes in Depth</a></li><li><a href="https://ponyfoo.com/articles/es6-maps-in-depth" aria-label="Read the article!" class="ra-link lk-link lk-link-to-green lk-visitor-before lk-visitor-before-no-underline lk-visitor-large md-markdown md-markdown-inline">ES6 Maps in Depth</a></li><li><a href="https://ponyfoo.com/articles/es6-symbols-in-depth" aria-label="Read the article!" class="ra-link lk-link lk-link-to-green lk-visitor-before lk-visitor-before-no-underline lk-visitor-large md-markdown md-markdown-inline">ES6 Symbols in Depth</a></li><li><a href="https://ponyfoo.com/articles/progressive-app-serviceworker" aria-label="Read the article!" class="ra-link lk-link lk-link-to-green lk-visitor-before lk-visitor-before-no-underline lk-visitor-large md-markdown md-markdown-inline">Making a Progressive App with ServiceWorker</a></li></ul></section></article><section class="ra-history md-markdown"><p><span>Pony Foo has been online for a while. Maybe you should check out the </span><a href="https://ponyfoo.com/articles/history" aria-label="May contain traces of gems and packages">article publication history</a><span>!</span></p></section></aside></section><div class="sp-line-wrapper uv-hidden"><div class="sp-line" style="width: 100%;"></div></div></main><footer class="fn-footer ly-footer"><span class="fn-social"><a href="https://facebook.com/ponyfoo" target="_blank" rel="noopener noreferrer" aria-label="Like us on Facebook!" class="fn-link lk-rainbows fn-icon fn-facebook"><i class="fa fa-facebook"></i></a><span> </span><a href="https://twitter.com/ponyfoo" target="_blank" rel="noopener noreferrer" aria-label="Follow us on Twitter!" class="fn-link lk-rainbows fn-icon fn-twitter"><i class="fa fa-twitter"></i></a><span> </span><a data-email="mailto:hello@ponyfoo.com" target="_blank" rel="noopener noreferrer" aria-label="Reach out to us!" class="fn-link lk-rainbows fn-icon fn-email" href="mailto:hello@ponyfoo.com"><i class="fa fa-envelope"></i></a><span> </span></span><a href="https://ponyfoo.com/about" aria-label="Learn more about Pony Foo" class="fn-link lk-rainbows">About</a><span> </span><a href="https://ponyfoo.com/articles/history" aria-label="Pony Foo has been online for a while!" class="fn-link lk-rainbows">History</a><span> </span><a href="https://ponyfoo.com/contributors/join-us" aria-label="Join the team at Pony Foo" class="fn-link lk-rainbows">Write With Us</a><span> </span><a href="https://shop.ponyfoo.com/" ria-label="Get some of our swag!" target="_blank" rel="noopener noreferrer" class="fn-link lk-rainbows">Shop</a><span> </span><a href="https://ponyfoo.com/weekly/sponsor" aria-label="Learn about our sponsorship opportunities and advertise with us!" class="fn-link lk-rainbows">Advertise</a><span> </span><a href="https://ponyfoo.com/subscribe" aria-label="Subscribe to our mailing list" class="fn-link lk-rainbows">Subscribe</a><span> </span><a href="https://ponyfoo.com/polls" aria-label="Check out our polls!" class="fn-link lk-rainbows">Polls</a><span> </span><a href="https://feeds.feedburner.com/ponyfoo" target="_blank" rel="noopener noreferrer" aria-label="Track the RSS feed and be the first to learn about freshly published content" class="fn-link lk-rainbows"><span class="fa fa-rss"></span><span> RSS</span></a><span> </span><a href="https://ponyfoo.com/license" class="fn-link lk-rainbows">License</a><span> </span><a href="https://ponyfoo.com/privacy" class="fn-link lk-rainbows">Privacy</a></footer><script nonce="">!function(){function n(t,e,r){function o(i,u){if(!e[i]){if(!t[i]){var c="function"==typeof require&&require;if(!u&&c)return c(i,!0);if(a)return a(i,!0);var d=Error("Cannot find module '"+i+"'");throw d.code="MODULE_NOT_FOUND",d}var s=e[i]={exports:{}};t[i][0].call(s.exports,function(n){return o(t[i][1][n]||n)},s,s.exports,n,t,e,r)}return e[i].exports}for(var a="function"==typeof require&&require,i=0;i<r.length;i++)o(r[i]);return o}return n}()({1:[function(n,t,e){"use strict";function r(n){var t=document.createElement("script");t.src=n,document.body.appendChild(t)}function o(){var n=location.search,t=n?"&"+n.substr(1):"";r(location.pathname+"?json&callback=taunusReady"+t),r("/js/all.a2dac4ff.js")}window.taunusReady=function(n){window.taunusReady=n},window.addEventListener?window.addEventListener("load",o,!1):window.attachEvent?window.attachEvent("onload",o):window.onload=o},{}]},{},[1]);</script><script src="./Content-Security-Policy in Express apps_files/content-security-policy-in-express-apps"></script><script src="./Content-Security-Policy in Express apps_files/all.a2dac4ff.js"></script><iframe style="display: none;" src="./Content-Security-Policy in Express apps_files/saved_resource.html"></iframe><iframe style="display: none;" src="./Content-Security-Policy in Express apps_files/saved_resource(1).html"></iframe><iframe style="display: none;" src="./Content-Security-Policy in Express apps_files/saved_resource(2).html"></iframe><span class="gg-container ll-loading gg-continuous"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="156" height="156" viewBox="0 0 13 13" shape-rendering="crispEdges" aria-hidden="true" class="go-logo"><rect width="1" height="1" x="11" fill="#666666"></rect><rect width="1" height="1" x="12" fill="#1a1a1a"></rect><rect width="1" height="1" x="10" y="1" fill="#4d4d4d"></rect><rect width="1" height="1" x="11" y="1"></rect><rect width="1" height="1" x="3" y="2" fill="#333333"></rect><rect width="1" height="1" x="4" y="2"></rect><rect width="1" height="1" x="5" y="2" fill="#1a1a1a"></rect><rect width="1" height="1" x="7" y="2" fill="#1a1a1a"></rect><rect width="1" height="1" x="9" y="2" fill="#333333"></rect><rect width="1" height="1" x="10" y="2"></rect><rect width="1" height="1" x="2" y="3" fill="#333333"></rect><rect width="1" height="1" x="3" y="3"></rect><rect width="1" height="1" x="4" y="3"></rect><rect width="1" height="1" x="5" y="3"></rect><rect width="1" height="1" x="6" y="3"></rect><rect width="1" height="1" x="7" y="3"></rect><rect width="1" height="1" x="8" y="3"></rect><rect width="1" height="1" x="9" y="3"></rect><rect width="1" height="1" x="1" y="4" fill="#333333"></rect><rect width="1" height="1" x="2" y="4" fill="#1a1a1a"></rect><rect width="1" height="1" x="3" y="4"></rect><rect width="1" height="1" x="4" y="4"></rect><rect width="1" height="1" x="5" y="4"></rect><rect width="1" height="1" x="6" y="4"></rect><rect width="1" height="1" x="7" y="4"></rect><rect width="1" height="1" x="8" y="4"></rect><rect width="1" height="1" x="9" y="4"></rect><rect width="1" height="1" y="5" fill="#333333"></rect><rect width="1" height="1" x="1" y="5" fill="#1a1a1a"></rect><rect width="1" height="1" x="2" y="5"></rect><rect width="1" height="1" x="3" y="5"></rect><rect width="1" height="1" x="4" y="5"></rect><rect width="1" height="1" x="5" y="5"></rect><rect width="1" height="1" x="6" y="5" fill="#26ef00"></rect><rect width="1" height="1" x="7" y="5" fill="#26e400"></rect><rect width="1" height="1" x="8" y="5"></rect><rect width="1" height="1" x="9" y="5"></rect><rect width="1" height="1" x="10" y="5" fill="#1a1a1a"></rect><rect width="1" height="1" y="6"></rect><rect width="1" height="1" x="1" y="6"></rect><rect width="1" height="1" x="2" y="6"></rect><rect width="1" height="1" x="3" y="6"></rect><rect width="1" height="1" x="4" y="6"></rect><rect width="1" height="1" x="5" y="6"></rect><rect width="1" height="1" x="6" y="6" fill="#26ef00"></rect><rect width="1" height="1" x="7" y="6" fill="#26ef00"></rect><rect width="1" height="1" x="8" y="6"></rect><rect width="1" height="1" x="9" y="6"></rect><rect width="1" height="1" y="7"></rect><rect width="1" height="1" x="1" y="7"></rect><rect width="1" height="1" x="2" y="7"></rect><rect width="1" height="1" x="3" y="7"></rect><rect width="1" height="1" x="4" y="7"></rect><rect width="1" height="1" x="5" y="7"></rect><rect width="1" height="1" x="6" y="7"></rect><rect width="1" height="1" x="7" y="7"></rect><rect width="1" height="1" x="8" y="7"></rect><rect width="1" height="1" x="9" y="7"></rect><rect width="1" height="1" y="8"></rect><rect width="1" height="1" x="1" y="8"></rect><rect width="1" height="1" x="2" y="8"></rect><rect width="1" height="1" x="3" y="8"></rect><rect width="1" height="1" x="4" y="8"></rect><rect width="1" height="1" x="5" y="8"></rect><rect width="1" height="1" x="6" y="8"></rect><rect width="1" height="1" x="7" y="8"></rect><rect width="1" height="1" x="8" y="8"></rect><rect width="1" height="1" x="9" y="8"></rect><rect width="1" height="1" x="10" y="8" fill="#333333"></rect><rect width="1" height="1" y="9"></rect><rect width="1" height="1" x="1" y="9"></rect><rect width="1" height="1" x="2" y="9"></rect><rect width="1" height="1" x="3" y="9"></rect><rect width="1" height="1" x="4" y="9"></rect><rect width="1" height="1" x="5" y="9"></rect><rect width="1" height="1" x="6" y="9"></rect><rect width="1" height="1" x="7" y="9"></rect><rect width="1" height="1" x="8" y="9"></rect><rect width="1" height="1" x="9" y="9"></rect><rect width="1" height="1" x="10" y="9"></rect><rect width="1" height="1" y="10"></rect><rect width="1" height="1" x="1" y="10"></rect><rect width="1" height="1" x="2" y="10"></rect><rect width="1" height="1" x="3" y="10"></rect><rect width="1" height="1" x="4" y="10"></rect><rect width="1" height="1" x="5" y="10"></rect><rect width="1" height="1" x="6" y="10" fill="#333333"></rect><rect width="1" height="1" x="8" y="10"></rect><rect width="1" height="1" x="9" y="10"></rect><rect width="1" height="1" x="10" y="10"></rect><rect width="1" height="1" y="11"></rect><rect width="1" height="1" x="1" y="11"></rect><rect width="1" height="1" x="2" y="11"></rect><rect width="1" height="1" x="3" y="11"></rect><rect width="1" height="1" x="4" y="11"></rect><rect width="1" height="1" x="5" y="11"></rect><rect width="1" height="1" x="6" y="11"></rect><rect width="1" height="1" x="7" y="11" fill="#333333"></rect><rect width="1" height="1" y="12"></rect><rect width="1" height="1" x="1" y="12"></rect><rect width="1" height="1" x="2" y="12"></rect><rect width="1" height="1" x="3" y="12"></rect><rect width="1" height="1" x="4" y="12"></rect><rect width="1" height="1" x="5" y="12"></rect><rect width="1" height="1" x="6" y="12"></rect><rect width="1" height="1" x="7" y="12"></rect><rect width="1" height="1" x="8" y="12" fill="#333333"></rect><a xlink:href="/" aria-hidden="false" role="link" title="Pony Foo"><rect width="13" height="13" opacity="0" role="img"></rect></a><image src="/img/logos/original.d316b6e4.png" alt="Pony Foo" class="go-logo-image"></image></svg></span><iframe scrolling="no" frameborder="0" allowtransparency="true" src="./Content-Security-Policy in Express apps_files/widget_iframe.6e189c4f2b6d88c453045806323cdcf3.html" title="Twitter settings iframe" style="display: none;"></iframe><script type="text/javascript" async="" src="./Content-Security-Policy in Express apps_files/in.php"></script><iframe id="rufous-sandbox" scrolling="no" frameborder="0" allowtransparency="true" allowfullscreen="true" style="position: absolute; visibility: hidden; display: none; width: 0px; height: 0px; padding: 0px; border: none;" title="Twitter analytics iframe" src="./Content-Security-Policy in Express apps_files/saved_resource(3).html"></iframe><script src="./Content-Security-Policy in Express apps_files/adsct" type="text/javascript"></script><script src="./Content-Security-Policy in Express apps_files/adsct" type="text/javascript"></script><script type="text/javascript" async="" src="./Content-Security-Policy in Express apps_files/in(1).php"></script><style data-context="hint"></style></body></html>